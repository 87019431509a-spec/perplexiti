2026-01-31 16:21:55 [INF] Конфигурация загружена
2026-01-31 16:21:55 [DEB] executing <function connect.<locals>.connector at 0x0000000003157380>
2026-01-31 16:21:55 [DEB] operation <function connect.<locals>.connector at 0x0000000003157380> completed
2026-01-31 16:21:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000003B525C0>, "\n            CREATE TABLE IF NOT EXISTS accounts (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                phone TEXT UNIQUE,\n                session_file TEXT,\n                pool_type TEXT DEFAULT 'comments',\n                status TEXT DEFAULT 'active',\n                warmup_level INTEGER DEFAULT 0,\n                comments_today INTEGER DEFAULT 0,\n                last_comment_at TEXT,\n                last_error TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", [])
2026-01-31 16:21:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000003B525C0>, "\n            CREATE TABLE IF NOT EXISTS accounts (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                phone TEXT UNIQUE,\n                session_file TEXT,\n                pool_type TEXT DEFAULT 'comments',\n                status TEXT DEFAULT 'active',\n                warmup_level INTEGER DEFAULT 0,\n                comments_today INTEGER DEFAULT 0,\n                last_comment_at TEXT,\n                last_error TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", []) completed
2026-01-31 16:21:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000003B525C0>, "\n            CREATE TABLE IF NOT EXISTS channels (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                channel_id INTEGER UNIQUE,\n                username TEXT,\n                title TEXT,\n                discussion_id INTEGER,\n                status TEXT DEFAULT 'active',\n                deletion_count INTEGER DEFAULT 0,\n                last_post_at TEXT,\n                last_comment_at TEXT,\n                sleep_until TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", [])
2026-01-31 16:21:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000003B525C0>, "\n            CREATE TABLE IF NOT EXISTS channels (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                channel_id INTEGER UNIQUE,\n                username TEXT,\n                title TEXT,\n                discussion_id INTEGER,\n                status TEXT DEFAULT 'active',\n                deletion_count INTEGER DEFAULT 0,\n                last_post_at TEXT,\n                last_comment_at TEXT,\n                sleep_until TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", []) completed
2026-01-31 16:21:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000003B525C0>, "\n            CREATE TABLE IF NOT EXISTS comments (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                comment_id INTEGER NOT NULL,\n                peer_id INTEGER NOT NULL,\n                channel_id INTEGER NOT NULL,\n                account_id INTEGER NOT NULL,\n                post_id INTEGER NOT NULL,\n                text TEXT,\n                status TEXT DEFAULT 'sent',\n                checked_at TEXT,\n                deleted_at TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                UNIQUE(peer_id, comment_id)\n            )\n        ", [])
2026-01-31 16:21:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000003B525C0>, "\n            CREATE TABLE IF NOT EXISTS comments (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                comment_id INTEGER NOT NULL,\n                peer_id INTEGER NOT NULL,\n                channel_id INTEGER NOT NULL,\n                account_id INTEGER NOT NULL,\n                post_id INTEGER NOT NULL,\n                text TEXT,\n                status TEXT DEFAULT 'sent',\n                checked_at TEXT,\n                deleted_at TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                UNIQUE(peer_id, comment_id)\n            )\n        ", []) completed
2026-01-31 16:21:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000003B525C0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_status \n            ON comments(status)\n        ', [])
2026-01-31 16:21:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000003B525C0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_status \n            ON comments(status)\n        ', []) completed
2026-01-31 16:21:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000003B525C0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_channel \n            ON comments(channel_id)\n        ', [])
2026-01-31 16:21:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000003B525C0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_channel \n            ON comments(channel_id)\n        ', []) completed
2026-01-31 16:21:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000003B525C0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_peer \n            ON comments(peer_id, comment_id)\n        ', [])
2026-01-31 16:21:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000003B525C0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_peer \n            ON comments(peer_id, comment_id)\n        ', []) completed
2026-01-31 16:21:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000003B525C0>, '\n            CREATE TABLE IF NOT EXISTS actions (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                action_type TEXT,\n                account_id INTEGER,\n                channel_id INTEGER,\n                details TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ', [])
2026-01-31 16:21:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000003B525C0>, '\n            CREATE TABLE IF NOT EXISTS actions (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                action_type TEXT,\n                account_id INTEGER,\n                channel_id INTEGER,\n                details TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ', []) completed
2026-01-31 16:21:55 [DEB] executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000000003B525C0>)
2026-01-31 16:21:55 [DEB] operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000000003B525C0>) completed
2026-01-31 16:21:55 [INF] База данных инициализирована: C:\Users\admin\Desktop\project\data\bot.db
2026-01-31 16:21:55 [INF] База данных инициализирована
2026-01-31 16:22:05 [INF] ==================================================
2026-01-31 16:22:05 [INF] ЗАПУСК СЕРВИСА КОММЕНТИРОВАНИЯ
2026-01-31 16:22:05 [INF] ==================================================
2026-01-31 16:22:05 [DEB] [SCHEDULER] Задача зарегистрирована: commenting
2026-01-31 16:22:05 [INF] Комментирование запущено
2026-01-31 16:22:05 [INF] ==================================================
2026-01-31 16:22:05 [INF] ЗАПУСК МОНИТОРИНГА КОММЕНТАРИЕВ
2026-01-31 16:22:05 [INF] ==================================================
2026-01-31 16:22:05 [DEB] [SCHEDULER] Задача зарегистрирована: monitor
2026-01-31 16:22:05 [INF] Мониторинг запущен
2026-01-31 16:22:05 [INF] Открыто окно логов: comments
2026-01-31 16:22:05 [INF] Комментирование запущено
2026-01-31 16:22:05 [INF] Запущен главный цикл комментирования
2026-01-31 16:22:05 [WAR] Нет активных аккаунтов для комментирования
2026-01-31 16:22:05 [INF] Пауза между циклами: 84 сек
2026-01-31 16:22:05 [INF] Запущен цикл мониторинга
2026-01-31 16:22:05 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000003B525C0>, "\n                SELECT * FROM comments \n                WHERE status = 'sent'\n                ORDER BY created_at ASC\n                LIMIT ?\n            ", (50,))
2026-01-31 16:22:05 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000003B525C0>, "\n                SELECT * FROM comments \n                WHERE status = 'sent'\n                ORDER BY created_at ASC\n                LIMIT ?\n            ", (50,)) completed
2026-01-31 16:22:05 [DEB] executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000000007E0F040>)
2026-01-31 16:22:05 [DEB] operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000000007E0F040>) completed
2026-01-31 16:22:05 [DEB] Нет комментариев для проверки
2026-01-31 16:22:05 [DEB] Следующая проверка через 60 сек
2026-01-31 22:19:55 [INF] Конфигурация загружена
2026-01-31 22:19:55 [DEB] executing <function connect.<locals>.connector at 0x0000000002CA5E40>
2026-01-31 22:19:55 [DEB] operation <function connect.<locals>.connector at 0x0000000002CA5E40> completed
2026-01-31 22:19:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000035A24D0>, "\n            CREATE TABLE IF NOT EXISTS accounts (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                phone TEXT UNIQUE,\n                session_file TEXT,\n                pool_type TEXT DEFAULT 'comments',\n                status TEXT DEFAULT 'active',\n                warmup_level INTEGER DEFAULT 0,\n                comments_today INTEGER DEFAULT 0,\n                last_comment_at TEXT,\n                last_error TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", [])
2026-01-31 22:19:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000035A24D0>, "\n            CREATE TABLE IF NOT EXISTS accounts (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                phone TEXT UNIQUE,\n                session_file TEXT,\n                pool_type TEXT DEFAULT 'comments',\n                status TEXT DEFAULT 'active',\n                warmup_level INTEGER DEFAULT 0,\n                comments_today INTEGER DEFAULT 0,\n                last_comment_at TEXT,\n                last_error TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", []) completed
2026-01-31 22:19:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000035A24D0>, "\n            CREATE TABLE IF NOT EXISTS channels (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                channel_id INTEGER UNIQUE,\n                username TEXT,\n                title TEXT,\n                discussion_id INTEGER,\n                status TEXT DEFAULT 'active',\n                deletion_count INTEGER DEFAULT 0,\n                last_post_at TEXT,\n                last_comment_at TEXT,\n                sleep_until TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", [])
2026-01-31 22:19:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000035A24D0>, "\n            CREATE TABLE IF NOT EXISTS channels (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                channel_id INTEGER UNIQUE,\n                username TEXT,\n                title TEXT,\n                discussion_id INTEGER,\n                status TEXT DEFAULT 'active',\n                deletion_count INTEGER DEFAULT 0,\n                last_post_at TEXT,\n                last_comment_at TEXT,\n                sleep_until TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", []) completed
2026-01-31 22:19:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000035A24D0>, "\n            CREATE TABLE IF NOT EXISTS comments (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                comment_id INTEGER NOT NULL,\n                peer_id INTEGER NOT NULL,\n                channel_id INTEGER NOT NULL,\n                account_id INTEGER NOT NULL,\n                post_id INTEGER NOT NULL,\n                text TEXT,\n                status TEXT DEFAULT 'sent',\n                checked_at TEXT,\n                deleted_at TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                UNIQUE(peer_id, comment_id)\n            )\n        ", [])
2026-01-31 22:19:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000035A24D0>, "\n            CREATE TABLE IF NOT EXISTS comments (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                comment_id INTEGER NOT NULL,\n                peer_id INTEGER NOT NULL,\n                channel_id INTEGER NOT NULL,\n                account_id INTEGER NOT NULL,\n                post_id INTEGER NOT NULL,\n                text TEXT,\n                status TEXT DEFAULT 'sent',\n                checked_at TEXT,\n                deleted_at TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                UNIQUE(peer_id, comment_id)\n            )\n        ", []) completed
2026-01-31 22:19:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000035A24D0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_status \n            ON comments(status)\n        ', [])
2026-01-31 22:19:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000035A24D0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_status \n            ON comments(status)\n        ', []) completed
2026-01-31 22:19:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000035A24D0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_channel \n            ON comments(channel_id)\n        ', [])
2026-01-31 22:19:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000035A24D0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_channel \n            ON comments(channel_id)\n        ', []) completed
2026-01-31 22:19:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000035A24D0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_peer \n            ON comments(peer_id, comment_id)\n        ', [])
2026-01-31 22:19:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000035A24D0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_peer \n            ON comments(peer_id, comment_id)\n        ', []) completed
2026-01-31 22:19:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000035A24D0>, '\n            CREATE TABLE IF NOT EXISTS actions (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                action_type TEXT,\n                account_id INTEGER,\n                channel_id INTEGER,\n                details TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ', [])
2026-01-31 22:19:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000035A24D0>, '\n            CREATE TABLE IF NOT EXISTS actions (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                action_type TEXT,\n                account_id INTEGER,\n                channel_id INTEGER,\n                details TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ', []) completed
2026-01-31 22:19:55 [DEB] executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000000035A24D0>)
2026-01-31 22:19:55 [DEB] operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000000035A24D0>) completed
2026-01-31 22:19:55 [INF] База данных инициализирована: C:\Users\admin\Desktop\project\data\bot.db
2026-01-31 22:19:55 [INF] База данных инициализирована
2026-01-31 22:20:06 [INF] ==================================================
2026-01-31 22:20:06 [INF] ЗАПУСК СЕРВИСА КОММЕНТИРОВАНИЯ
2026-01-31 22:20:06 [INF] ==================================================
2026-01-31 22:20:06 [DEB] [SCHEDULER] Задача зарегистрирована: commenting
2026-01-31 22:20:06 [INF] Комментирование запущено
2026-01-31 22:20:06 [INF] ==================================================
2026-01-31 22:20:06 [INF] ЗАПУСК МОНИТОРИНГА КОММЕНТАРИЕВ
2026-01-31 22:20:06 [INF] ==================================================
2026-01-31 22:20:06 [DEB] [SCHEDULER] Задача зарегистрирована: monitor
2026-01-31 22:20:06 [INF] Мониторинг запущен
2026-01-31 22:20:06 [INF] Открыто окно логов: comments
2026-01-31 22:20:06 [INF] Комментирование запущено
2026-01-31 22:20:06 [INF] Запущен главный цикл комментирования
2026-01-31 22:20:06 [WAR] Нет активных аккаунтов для комментирования
2026-01-31 22:20:06 [INF] Пауза между циклами: 195 сек
2026-01-31 22:20:06 [INF] Запущен цикл мониторинга
2026-01-31 22:20:06 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000035A24D0>, "\n                SELECT * FROM comments \n                WHERE status = 'sent'\n                ORDER BY created_at ASC\n                LIMIT ?\n            ", (50,))
2026-01-31 22:20:06 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000035A24D0>, "\n                SELECT * FROM comments \n                WHERE status = 'sent'\n                ORDER BY created_at ASC\n                LIMIT ?\n            ", (50,)) completed
2026-01-31 22:20:06 [DEB] executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000000007EE1EC0>)
2026-01-31 22:20:06 [DEB] operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000000007EE1EC0>) completed
2026-01-31 22:20:06 [DEB] Нет комментариев для проверки
2026-01-31 22:20:06 [DEB] Следующая проверка через 60 сек
2026-02-01 03:03:53 [DEB] executing <function connect.<locals>.connector at 0x0000000008498720>
2026-02-01 03:03:53 [DEB] operation <function connect.<locals>.connector at 0x0000000008498720> completed
2026-02-01 03:03:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008856C50>, "\n            CREATE TABLE IF NOT EXISTS accounts (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                phone TEXT UNIQUE,\n                session_file TEXT,\n                pool_type TEXT DEFAULT 'comments',\n                status TEXT DEFAULT 'active',\n                warmup_level INTEGER DEFAULT 0,\n                comments_today INTEGER DEFAULT 0,\n                last_comment_at TEXT,\n                last_error TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", [])
2026-02-01 03:03:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008856C50>, "\n            CREATE TABLE IF NOT EXISTS accounts (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                phone TEXT UNIQUE,\n                session_file TEXT,\n                pool_type TEXT DEFAULT 'comments',\n                status TEXT DEFAULT 'active',\n                warmup_level INTEGER DEFAULT 0,\n                comments_today INTEGER DEFAULT 0,\n                last_comment_at TEXT,\n                last_error TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", []) completed
2026-02-01 03:03:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008856C50>, "\n            CREATE TABLE IF NOT EXISTS channels (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                channel_id INTEGER UNIQUE,\n                username TEXT,\n                title TEXT,\n                discussion_id INTEGER,\n                status TEXT DEFAULT 'active',\n                deletion_count INTEGER DEFAULT 0,\n                last_post_at TEXT,\n                last_comment_at TEXT,\n                sleep_until TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", [])
2026-02-01 03:03:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008856C50>, "\n            CREATE TABLE IF NOT EXISTS channels (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                channel_id INTEGER UNIQUE,\n                username TEXT,\n                title TEXT,\n                discussion_id INTEGER,\n                status TEXT DEFAULT 'active',\n                deletion_count INTEGER DEFAULT 0,\n                last_post_at TEXT,\n                last_comment_at TEXT,\n                sleep_until TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", []) completed
2026-02-01 03:03:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008856C50>, "\n            CREATE TABLE IF NOT EXISTS comments (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                comment_id INTEGER NOT NULL,\n                peer_id INTEGER NOT NULL,\n                channel_id INTEGER NOT NULL,\n                account_id INTEGER NOT NULL,\n                post_id INTEGER NOT NULL,\n                text TEXT,\n                status TEXT DEFAULT 'sent',\n                checked_at TEXT,\n                deleted_at TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                UNIQUE(peer_id, comment_id)\n            )\n        ", [])
2026-02-01 03:03:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008856C50>, "\n            CREATE TABLE IF NOT EXISTS comments (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                comment_id INTEGER NOT NULL,\n                peer_id INTEGER NOT NULL,\n                channel_id INTEGER NOT NULL,\n                account_id INTEGER NOT NULL,\n                post_id INTEGER NOT NULL,\n                text TEXT,\n                status TEXT DEFAULT 'sent',\n                checked_at TEXT,\n                deleted_at TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                UNIQUE(peer_id, comment_id)\n            )\n        ", []) completed
2026-02-01 03:03:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008856C50>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_status \n            ON comments(status)\n        ', [])
2026-02-01 03:03:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008856C50>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_status \n            ON comments(status)\n        ', []) completed
2026-02-01 03:03:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008856C50>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_channel \n            ON comments(channel_id)\n        ', [])
2026-02-01 03:03:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008856C50>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_channel \n            ON comments(channel_id)\n        ', []) completed
2026-02-01 03:03:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008856C50>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_peer \n            ON comments(peer_id, comment_id)\n        ', [])
2026-02-01 03:03:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008856C50>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_peer \n            ON comments(peer_id, comment_id)\n        ', []) completed
2026-02-01 03:03:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008856C50>, '\n            CREATE TABLE IF NOT EXISTS actions (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                action_type TEXT,\n                account_id INTEGER,\n                channel_id INTEGER,\n                details TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ', [])
2026-02-01 03:03:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008856C50>, '\n            CREATE TABLE IF NOT EXISTS actions (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                action_type TEXT,\n                account_id INTEGER,\n                channel_id INTEGER,\n                details TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ', []) completed
2026-02-01 03:03:53 [DEB] executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000000008856C50>)
2026-02-01 03:03:53 [DEB] operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000000008856C50>) completed
2026-02-01 03:03:53 [DEB] executing <function Connection.stop.<locals>.close_and_stop at 0x00000000084984A0>
2026-02-01 03:03:53 [DEB] operation <function Connection.stop.<locals>.close_and_stop at 0x00000000084984A0> completed
2026-02-01 03:03:53 [INF] База данных инициализирована: C:\Users\admin\Desktop\project\data\bot.db
2026-02-01 03:03:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008856C50>, '\n                    SELECT COUNT(*) FROM comments \n                    WHERE date(created_at) = ?\n                ', ('2026-02-01',))
2026-02-01 03:03:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008856C50>, '\n                    SELECT COUNT(*) FROM comments \n                    WHERE date(created_at) = ?\n                ', ('2026-02-01',)) completed
2026-02-01 03:03:53 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884A340>)
2026-02-01 03:03:53 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884A340>) completed
2026-02-01 03:03:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008856C50>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'sent' AND date(created_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:03:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008856C50>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'sent' AND date(created_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:03:53 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884A240>)
2026-02-01 03:03:53 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884A240>) completed
2026-02-01 03:03:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008856C50>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'deleted' AND date(deleted_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:03:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008856C50>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'deleted' AND date(deleted_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:03:53 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884A540>)
2026-02-01 03:03:53 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884A540>) completed
2026-02-01 03:03:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008856C50>, "\n                    SELECT COUNT(*) FROM actions \n                    WHERE action_type = 'warmup' AND date(created_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:03:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008856C50>, "\n                    SELECT COUNT(*) FROM actions \n                    WHERE action_type = 'warmup' AND date(created_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:03:53 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884A4C0>)
2026-02-01 03:03:53 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884A4C0>) completed
2026-02-01 03:04:23 [DEB] executing <function connect.<locals>.connector at 0x00000000084993A0>
2026-02-01 03:04:23 [DEB] operation <function connect.<locals>.connector at 0x00000000084993A0> completed
2026-02-01 03:04:23 [DEB] executing <function Connection.stop.<locals>.close_and_stop at 0x00000000081D6160>
2026-02-01 03:04:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B06D0>, "\n            CREATE TABLE IF NOT EXISTS accounts (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                phone TEXT UNIQUE,\n                session_file TEXT,\n                pool_type TEXT DEFAULT 'comments',\n                status TEXT DEFAULT 'active',\n                warmup_level INTEGER DEFAULT 0,\n                comments_today INTEGER DEFAULT 0,\n                last_comment_at TEXT,\n                last_error TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", [])
2026-02-01 03:04:23 [DEB] operation <function Connection.stop.<locals>.close_and_stop at 0x00000000081D6160> completed
2026-02-01 03:04:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B06D0>, "\n            CREATE TABLE IF NOT EXISTS accounts (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                phone TEXT UNIQUE,\n                session_file TEXT,\n                pool_type TEXT DEFAULT 'comments',\n                status TEXT DEFAULT 'active',\n                warmup_level INTEGER DEFAULT 0,\n                comments_today INTEGER DEFAULT 0,\n                last_comment_at TEXT,\n                last_error TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", []) completed
2026-02-01 03:04:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B06D0>, "\n            CREATE TABLE IF NOT EXISTS channels (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                channel_id INTEGER UNIQUE,\n                username TEXT,\n                title TEXT,\n                discussion_id INTEGER,\n                status TEXT DEFAULT 'active',\n                deletion_count INTEGER DEFAULT 0,\n                last_post_at TEXT,\n                last_comment_at TEXT,\n                sleep_until TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", [])
2026-02-01 03:04:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B06D0>, "\n            CREATE TABLE IF NOT EXISTS channels (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                channel_id INTEGER UNIQUE,\n                username TEXT,\n                title TEXT,\n                discussion_id INTEGER,\n                status TEXT DEFAULT 'active',\n                deletion_count INTEGER DEFAULT 0,\n                last_post_at TEXT,\n                last_comment_at TEXT,\n                sleep_until TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", []) completed
2026-02-01 03:04:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B06D0>, "\n            CREATE TABLE IF NOT EXISTS comments (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                comment_id INTEGER NOT NULL,\n                peer_id INTEGER NOT NULL,\n                channel_id INTEGER NOT NULL,\n                account_id INTEGER NOT NULL,\n                post_id INTEGER NOT NULL,\n                text TEXT,\n                status TEXT DEFAULT 'sent',\n                checked_at TEXT,\n                deleted_at TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                UNIQUE(peer_id, comment_id)\n            )\n        ", [])
2026-02-01 03:04:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B06D0>, "\n            CREATE TABLE IF NOT EXISTS comments (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                comment_id INTEGER NOT NULL,\n                peer_id INTEGER NOT NULL,\n                channel_id INTEGER NOT NULL,\n                account_id INTEGER NOT NULL,\n                post_id INTEGER NOT NULL,\n                text TEXT,\n                status TEXT DEFAULT 'sent',\n                checked_at TEXT,\n                deleted_at TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                UNIQUE(peer_id, comment_id)\n            )\n        ", []) completed
2026-02-01 03:04:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B06D0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_status \n            ON comments(status)\n        ', [])
2026-02-01 03:04:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B06D0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_status \n            ON comments(status)\n        ', []) completed
2026-02-01 03:04:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B06D0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_channel \n            ON comments(channel_id)\n        ', [])
2026-02-01 03:04:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B06D0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_channel \n            ON comments(channel_id)\n        ', []) completed
2026-02-01 03:04:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B06D0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_peer \n            ON comments(peer_id, comment_id)\n        ', [])
2026-02-01 03:04:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B06D0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_peer \n            ON comments(peer_id, comment_id)\n        ', []) completed
2026-02-01 03:04:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B06D0>, '\n            CREATE TABLE IF NOT EXISTS actions (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                action_type TEXT,\n                account_id INTEGER,\n                channel_id INTEGER,\n                details TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ', [])
2026-02-01 03:04:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B06D0>, '\n            CREATE TABLE IF NOT EXISTS actions (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                action_type TEXT,\n                account_id INTEGER,\n                channel_id INTEGER,\n                details TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ', []) completed
2026-02-01 03:04:23 [DEB] executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000000084B06D0>)
2026-02-01 03:04:23 [DEB] operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000000084B06D0>) completed
2026-02-01 03:04:23 [INF] База данных инициализирована: C:\Users\admin\Desktop\project\data\bot.db
2026-02-01 03:04:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B06D0>, '\n                    SELECT COUNT(*) FROM comments \n                    WHERE date(created_at) = ?\n                ', ('2026-02-01',))
2026-02-01 03:04:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B06D0>, '\n                    SELECT COUNT(*) FROM comments \n                    WHERE date(created_at) = ?\n                ', ('2026-02-01',)) completed
2026-02-01 03:04:23 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B2C0>)
2026-02-01 03:04:23 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B2C0>) completed
2026-02-01 03:04:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B06D0>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'sent' AND date(created_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:04:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B06D0>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'sent' AND date(created_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:04:23 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B240>)
2026-02-01 03:04:23 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B240>) completed
2026-02-01 03:04:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B06D0>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'deleted' AND date(deleted_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:04:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B06D0>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'deleted' AND date(deleted_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:04:23 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B2C0>)
2026-02-01 03:04:23 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B2C0>) completed
2026-02-01 03:04:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B06D0>, "\n                    SELECT COUNT(*) FROM actions \n                    WHERE action_type = 'warmup' AND date(created_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:04:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B06D0>, "\n                    SELECT COUNT(*) FROM actions \n                    WHERE action_type = 'warmup' AND date(created_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:04:23 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B240>)
2026-02-01 03:04:23 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B240>) completed
2026-02-01 03:04:53 [DEB] executing <function connect.<locals>.connector at 0x0000000008499760>
2026-02-01 03:04:53 [DEB] operation <function connect.<locals>.connector at 0x0000000008499760> completed
2026-02-01 03:04:53 [DEB] executing <function Connection.stop.<locals>.close_and_stop at 0x0000000008498CC0>
2026-02-01 03:04:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1030>, "\n            CREATE TABLE IF NOT EXISTS accounts (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                phone TEXT UNIQUE,\n                session_file TEXT,\n                pool_type TEXT DEFAULT 'comments',\n                status TEXT DEFAULT 'active',\n                warmup_level INTEGER DEFAULT 0,\n                comments_today INTEGER DEFAULT 0,\n                last_comment_at TEXT,\n                last_error TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", [])
2026-02-01 03:04:53 [DEB] operation <function Connection.stop.<locals>.close_and_stop at 0x0000000008498CC0> completed
2026-02-01 03:04:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1030>, "\n            CREATE TABLE IF NOT EXISTS accounts (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                phone TEXT UNIQUE,\n                session_file TEXT,\n                pool_type TEXT DEFAULT 'comments',\n                status TEXT DEFAULT 'active',\n                warmup_level INTEGER DEFAULT 0,\n                comments_today INTEGER DEFAULT 0,\n                last_comment_at TEXT,\n                last_error TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", []) completed
2026-02-01 03:04:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1030>, "\n            CREATE TABLE IF NOT EXISTS channels (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                channel_id INTEGER UNIQUE,\n                username TEXT,\n                title TEXT,\n                discussion_id INTEGER,\n                status TEXT DEFAULT 'active',\n                deletion_count INTEGER DEFAULT 0,\n                last_post_at TEXT,\n                last_comment_at TEXT,\n                sleep_until TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", [])
2026-02-01 03:04:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1030>, "\n            CREATE TABLE IF NOT EXISTS channels (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                channel_id INTEGER UNIQUE,\n                username TEXT,\n                title TEXT,\n                discussion_id INTEGER,\n                status TEXT DEFAULT 'active',\n                deletion_count INTEGER DEFAULT 0,\n                last_post_at TEXT,\n                last_comment_at TEXT,\n                sleep_until TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", []) completed
2026-02-01 03:04:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1030>, "\n            CREATE TABLE IF NOT EXISTS comments (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                comment_id INTEGER NOT NULL,\n                peer_id INTEGER NOT NULL,\n                channel_id INTEGER NOT NULL,\n                account_id INTEGER NOT NULL,\n                post_id INTEGER NOT NULL,\n                text TEXT,\n                status TEXT DEFAULT 'sent',\n                checked_at TEXT,\n                deleted_at TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                UNIQUE(peer_id, comment_id)\n            )\n        ", [])
2026-02-01 03:04:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1030>, "\n            CREATE TABLE IF NOT EXISTS comments (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                comment_id INTEGER NOT NULL,\n                peer_id INTEGER NOT NULL,\n                channel_id INTEGER NOT NULL,\n                account_id INTEGER NOT NULL,\n                post_id INTEGER NOT NULL,\n                text TEXT,\n                status TEXT DEFAULT 'sent',\n                checked_at TEXT,\n                deleted_at TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                UNIQUE(peer_id, comment_id)\n            )\n        ", []) completed
2026-02-01 03:04:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1030>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_status \n            ON comments(status)\n        ', [])
2026-02-01 03:04:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1030>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_status \n            ON comments(status)\n        ', []) completed
2026-02-01 03:04:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1030>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_channel \n            ON comments(channel_id)\n        ', [])
2026-02-01 03:04:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1030>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_channel \n            ON comments(channel_id)\n        ', []) completed
2026-02-01 03:04:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1030>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_peer \n            ON comments(peer_id, comment_id)\n        ', [])
2026-02-01 03:04:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1030>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_peer \n            ON comments(peer_id, comment_id)\n        ', []) completed
2026-02-01 03:04:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1030>, '\n            CREATE TABLE IF NOT EXISTS actions (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                action_type TEXT,\n                account_id INTEGER,\n                channel_id INTEGER,\n                details TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ', [])
2026-02-01 03:04:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1030>, '\n            CREATE TABLE IF NOT EXISTS actions (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                action_type TEXT,\n                account_id INTEGER,\n                channel_id INTEGER,\n                details TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ', []) completed
2026-02-01 03:04:53 [DEB] executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000000084B1030>)
2026-02-01 03:04:53 [DEB] operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000000084B1030>) completed
2026-02-01 03:04:53 [INF] База данных инициализирована: C:\Users\admin\Desktop\project\data\bot.db
2026-02-01 03:04:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1030>, '\n                    SELECT COUNT(*) FROM comments \n                    WHERE date(created_at) = ?\n                ', ('2026-02-01',))
2026-02-01 03:04:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1030>, '\n                    SELECT COUNT(*) FROM comments \n                    WHERE date(created_at) = ?\n                ', ('2026-02-01',)) completed
2026-02-01 03:04:53 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884A3C0>)
2026-02-01 03:04:53 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884A3C0>) completed
2026-02-01 03:04:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1030>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'sent' AND date(created_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:04:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1030>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'sent' AND date(created_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:04:53 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B8C0>)
2026-02-01 03:04:53 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B8C0>) completed
2026-02-01 03:04:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1030>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'deleted' AND date(deleted_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:04:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1030>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'deleted' AND date(deleted_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:04:53 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884A3C0>)
2026-02-01 03:04:53 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884A3C0>) completed
2026-02-01 03:04:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1030>, "\n                    SELECT COUNT(*) FROM actions \n                    WHERE action_type = 'warmup' AND date(created_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:04:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1030>, "\n                    SELECT COUNT(*) FROM actions \n                    WHERE action_type = 'warmup' AND date(created_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:04:53 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B8C0>)
2026-02-01 03:04:53 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B8C0>) completed
2026-02-01 03:04:55 [DEB] executing <function connect.<locals>.connector at 0x0000000008498CC0>
2026-02-01 03:04:55 [DEB] executing <function Connection.stop.<locals>.close_and_stop at 0x0000000008499800>
2026-02-01 03:04:55 [DEB] operation <function Connection.stop.<locals>.close_and_stop at 0x0000000008499800> completed
2026-02-01 03:04:55 [DEB] operation <function connect.<locals>.connector at 0x0000000008498CC0> completed
2026-02-01 03:04:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1300>, "\n            CREATE TABLE IF NOT EXISTS accounts (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                phone TEXT UNIQUE,\n                session_file TEXT,\n                pool_type TEXT DEFAULT 'comments',\n                status TEXT DEFAULT 'active',\n                warmup_level INTEGER DEFAULT 0,\n                comments_today INTEGER DEFAULT 0,\n                last_comment_at TEXT,\n                last_error TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", [])
2026-02-01 03:04:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1300>, "\n            CREATE TABLE IF NOT EXISTS accounts (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                phone TEXT UNIQUE,\n                session_file TEXT,\n                pool_type TEXT DEFAULT 'comments',\n                status TEXT DEFAULT 'active',\n                warmup_level INTEGER DEFAULT 0,\n                comments_today INTEGER DEFAULT 0,\n                last_comment_at TEXT,\n                last_error TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", []) completed
2026-02-01 03:04:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1300>, "\n            CREATE TABLE IF NOT EXISTS channels (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                channel_id INTEGER UNIQUE,\n                username TEXT,\n                title TEXT,\n                discussion_id INTEGER,\n                status TEXT DEFAULT 'active',\n                deletion_count INTEGER DEFAULT 0,\n                last_post_at TEXT,\n                last_comment_at TEXT,\n                sleep_until TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", [])
2026-02-01 03:04:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1300>, "\n            CREATE TABLE IF NOT EXISTS channels (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                channel_id INTEGER UNIQUE,\n                username TEXT,\n                title TEXT,\n                discussion_id INTEGER,\n                status TEXT DEFAULT 'active',\n                deletion_count INTEGER DEFAULT 0,\n                last_post_at TEXT,\n                last_comment_at TEXT,\n                sleep_until TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", []) completed
2026-02-01 03:04:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1300>, "\n            CREATE TABLE IF NOT EXISTS comments (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                comment_id INTEGER NOT NULL,\n                peer_id INTEGER NOT NULL,\n                channel_id INTEGER NOT NULL,\n                account_id INTEGER NOT NULL,\n                post_id INTEGER NOT NULL,\n                text TEXT,\n                status TEXT DEFAULT 'sent',\n                checked_at TEXT,\n                deleted_at TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                UNIQUE(peer_id, comment_id)\n            )\n        ", [])
2026-02-01 03:04:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1300>, "\n            CREATE TABLE IF NOT EXISTS comments (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                comment_id INTEGER NOT NULL,\n                peer_id INTEGER NOT NULL,\n                channel_id INTEGER NOT NULL,\n                account_id INTEGER NOT NULL,\n                post_id INTEGER NOT NULL,\n                text TEXT,\n                status TEXT DEFAULT 'sent',\n                checked_at TEXT,\n                deleted_at TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                UNIQUE(peer_id, comment_id)\n            )\n        ", []) completed
2026-02-01 03:04:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1300>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_status \n            ON comments(status)\n        ', [])
2026-02-01 03:04:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1300>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_status \n            ON comments(status)\n        ', []) completed
2026-02-01 03:04:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1300>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_channel \n            ON comments(channel_id)\n        ', [])
2026-02-01 03:04:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1300>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_channel \n            ON comments(channel_id)\n        ', []) completed
2026-02-01 03:04:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1300>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_peer \n            ON comments(peer_id, comment_id)\n        ', [])
2026-02-01 03:04:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1300>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_peer \n            ON comments(peer_id, comment_id)\n        ', []) completed
2026-02-01 03:04:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1300>, '\n            CREATE TABLE IF NOT EXISTS actions (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                action_type TEXT,\n                account_id INTEGER,\n                channel_id INTEGER,\n                details TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ', [])
2026-02-01 03:04:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1300>, '\n            CREATE TABLE IF NOT EXISTS actions (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                action_type TEXT,\n                account_id INTEGER,\n                channel_id INTEGER,\n                details TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ', []) completed
2026-02-01 03:04:55 [DEB] executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000000084B1300>)
2026-02-01 03:04:55 [DEB] operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000000084B1300>) completed
2026-02-01 03:04:55 [INF] База данных инициализирована: C:\Users\admin\Desktop\project\data\bot.db
2026-02-01 03:04:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1300>, '\n                    SELECT COUNT(*) FROM comments \n                    WHERE date(created_at) = ?\n                ', ('2026-02-01',))
2026-02-01 03:04:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1300>, '\n                    SELECT COUNT(*) FROM comments \n                    WHERE date(created_at) = ?\n                ', ('2026-02-01',)) completed
2026-02-01 03:04:55 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B9C0>)
2026-02-01 03:04:55 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B9C0>) completed
2026-02-01 03:04:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1300>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'sent' AND date(created_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:04:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1300>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'sent' AND date(created_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:04:55 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B740>)
2026-02-01 03:04:55 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B740>) completed
2026-02-01 03:04:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1300>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'deleted' AND date(deleted_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:04:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1300>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'deleted' AND date(deleted_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:04:55 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884BAC0>)
2026-02-01 03:04:55 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884BAC0>) completed
2026-02-01 03:04:55 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1300>, "\n                    SELECT COUNT(*) FROM actions \n                    WHERE action_type = 'warmup' AND date(created_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:04:55 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B1300>, "\n                    SELECT COUNT(*) FROM actions \n                    WHERE action_type = 'warmup' AND date(created_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:04:55 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884BB40>)
2026-02-01 03:04:55 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884BB40>) completed
2026-02-01 03:05:14 [DEB] Calling on_part_begin with no data
2026-02-01 03:05:14 [DEB] Calling on_header_field with data[42:61]
2026-02-01 03:05:14 [DEB] Calling on_header_value with data[63:108]
2026-02-01 03:05:14 [DEB] Calling on_header_end with no data
2026-02-01 03:05:14 [DEB] Calling on_header_field with data[110:122]
2026-02-01 03:05:14 [DEB] Calling on_header_value with data[124:148]
2026-02-01 03:05:14 [DEB] Calling on_header_end with no data
2026-02-01 03:05:14 [DEB] Calling on_headers_finished with no data
2026-02-01 03:05:14 [DEB] Calling on_part_data with data[152:16384]
2026-02-01 03:05:14 [DEB] Calling on_part_data with data[0:12440]
2026-02-01 03:05:14 [DEB] Calling on_part_end with no data
2026-02-01 03:05:14 [DEB] Calling on_part_begin with no data
2026-02-01 03:05:14 [DEB] Calling on_header_field with data[12484:12503]
2026-02-01 03:05:14 [DEB] Calling on_header_value with data[12505:12535]
2026-02-01 03:05:14 [DEB] Calling on_header_end with no data
2026-02-01 03:05:14 [DEB] Calling on_headers_finished with no data
2026-02-01 03:05:14 [DEB] Calling on_part_data with data[12539:12547]
2026-02-01 03:05:14 [DEB] Calling on_part_end with no data
2026-02-01 03:05:14 [DEB] Calling on_end with no data
2026-02-01 03:05:14 [INF] Загружен session: 3.session
2026-02-01 03:05:23 [DEB] executing <function connect.<locals>.connector at 0x0000000008499760>
2026-02-01 03:05:23 [DEB] operation <function connect.<locals>.connector at 0x0000000008499760> completed
2026-02-01 03:05:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008855B70>, "\n            CREATE TABLE IF NOT EXISTS accounts (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                phone TEXT UNIQUE,\n                session_file TEXT,\n                pool_type TEXT DEFAULT 'comments',\n                status TEXT DEFAULT 'active',\n                warmup_level INTEGER DEFAULT 0,\n                comments_today INTEGER DEFAULT 0,\n                last_comment_at TEXT,\n                last_error TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", [])
2026-02-01 03:05:23 [DEB] executing <function Connection.stop.<locals>.close_and_stop at 0x0000000008499DA0>
2026-02-01 03:05:23 [DEB] operation <function Connection.stop.<locals>.close_and_stop at 0x0000000008499DA0> completed
2026-02-01 03:05:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008855B70>, "\n            CREATE TABLE IF NOT EXISTS accounts (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                phone TEXT UNIQUE,\n                session_file TEXT,\n                pool_type TEXT DEFAULT 'comments',\n                status TEXT DEFAULT 'active',\n                warmup_level INTEGER DEFAULT 0,\n                comments_today INTEGER DEFAULT 0,\n                last_comment_at TEXT,\n                last_error TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", []) completed
2026-02-01 03:05:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008855B70>, "\n            CREATE TABLE IF NOT EXISTS channels (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                channel_id INTEGER UNIQUE,\n                username TEXT,\n                title TEXT,\n                discussion_id INTEGER,\n                status TEXT DEFAULT 'active',\n                deletion_count INTEGER DEFAULT 0,\n                last_post_at TEXT,\n                last_comment_at TEXT,\n                sleep_until TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", [])
2026-02-01 03:05:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008855B70>, "\n            CREATE TABLE IF NOT EXISTS channels (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                channel_id INTEGER UNIQUE,\n                username TEXT,\n                title TEXT,\n                discussion_id INTEGER,\n                status TEXT DEFAULT 'active',\n                deletion_count INTEGER DEFAULT 0,\n                last_post_at TEXT,\n                last_comment_at TEXT,\n                sleep_until TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", []) completed
2026-02-01 03:05:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008855B70>, "\n            CREATE TABLE IF NOT EXISTS comments (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                comment_id INTEGER NOT NULL,\n                peer_id INTEGER NOT NULL,\n                channel_id INTEGER NOT NULL,\n                account_id INTEGER NOT NULL,\n                post_id INTEGER NOT NULL,\n                text TEXT,\n                status TEXT DEFAULT 'sent',\n                checked_at TEXT,\n                deleted_at TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                UNIQUE(peer_id, comment_id)\n            )\n        ", [])
2026-02-01 03:05:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008855B70>, "\n            CREATE TABLE IF NOT EXISTS comments (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                comment_id INTEGER NOT NULL,\n                peer_id INTEGER NOT NULL,\n                channel_id INTEGER NOT NULL,\n                account_id INTEGER NOT NULL,\n                post_id INTEGER NOT NULL,\n                text TEXT,\n                status TEXT DEFAULT 'sent',\n                checked_at TEXT,\n                deleted_at TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                UNIQUE(peer_id, comment_id)\n            )\n        ", []) completed
2026-02-01 03:05:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008855B70>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_status \n            ON comments(status)\n        ', [])
2026-02-01 03:05:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008855B70>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_status \n            ON comments(status)\n        ', []) completed
2026-02-01 03:05:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008855B70>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_channel \n            ON comments(channel_id)\n        ', [])
2026-02-01 03:05:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008855B70>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_channel \n            ON comments(channel_id)\n        ', []) completed
2026-02-01 03:05:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008855B70>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_peer \n            ON comments(peer_id, comment_id)\n        ', [])
2026-02-01 03:05:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008855B70>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_peer \n            ON comments(peer_id, comment_id)\n        ', []) completed
2026-02-01 03:05:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008855B70>, '\n            CREATE TABLE IF NOT EXISTS actions (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                action_type TEXT,\n                account_id INTEGER,\n                channel_id INTEGER,\n                details TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ', [])
2026-02-01 03:05:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008855B70>, '\n            CREATE TABLE IF NOT EXISTS actions (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                action_type TEXT,\n                account_id INTEGER,\n                channel_id INTEGER,\n                details TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ', []) completed
2026-02-01 03:05:23 [DEB] executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000000008855B70>)
2026-02-01 03:05:23 [DEB] operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000000008855B70>) completed
2026-02-01 03:05:23 [INF] База данных инициализирована: C:\Users\admin\Desktop\project\data\bot.db
2026-02-01 03:05:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008855B70>, '\n                    SELECT COUNT(*) FROM comments \n                    WHERE date(created_at) = ?\n                ', ('2026-02-01',))
2026-02-01 03:05:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008855B70>, '\n                    SELECT COUNT(*) FROM comments \n                    WHERE date(created_at) = ?\n                ', ('2026-02-01',)) completed
2026-02-01 03:05:23 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884BB40>)
2026-02-01 03:05:23 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884BB40>) completed
2026-02-01 03:05:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008855B70>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'sent' AND date(created_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:05:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008855B70>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'sent' AND date(created_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:05:23 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884BA40>)
2026-02-01 03:05:23 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884BA40>) completed
2026-02-01 03:05:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008855B70>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'deleted' AND date(deleted_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:05:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008855B70>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'deleted' AND date(deleted_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:05:23 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B9C0>)
2026-02-01 03:05:23 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B9C0>) completed
2026-02-01 03:05:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008855B70>, "\n                    SELECT COUNT(*) FROM actions \n                    WHERE action_type = 'warmup' AND date(created_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:05:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000000008855B70>, "\n                    SELECT COUNT(*) FROM actions \n                    WHERE action_type = 'warmup' AND date(created_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:05:23 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B7C0>)
2026-02-01 03:05:23 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B7C0>) completed
2026-02-01 03:05:24 [DEB] executing <function connect.<locals>.connector at 0x00000000084991C0>
2026-02-01 03:05:24 [DEB] operation <function connect.<locals>.connector at 0x00000000084991C0> completed
2026-02-01 03:05:24 [DEB] executing <function Connection.stop.<locals>.close_and_stop at 0x0000000008499260>
2026-02-01 03:05:24 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000088565C0>, "\n            CREATE TABLE IF NOT EXISTS accounts (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                phone TEXT UNIQUE,\n                session_file TEXT,\n                pool_type TEXT DEFAULT 'comments',\n                status TEXT DEFAULT 'active',\n                warmup_level INTEGER DEFAULT 0,\n                comments_today INTEGER DEFAULT 0,\n                last_comment_at TEXT,\n                last_error TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", [])
2026-02-01 03:05:24 [DEB] operation <function Connection.stop.<locals>.close_and_stop at 0x0000000008499260> completed
2026-02-01 03:05:24 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000088565C0>, "\n            CREATE TABLE IF NOT EXISTS accounts (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                phone TEXT UNIQUE,\n                session_file TEXT,\n                pool_type TEXT DEFAULT 'comments',\n                status TEXT DEFAULT 'active',\n                warmup_level INTEGER DEFAULT 0,\n                comments_today INTEGER DEFAULT 0,\n                last_comment_at TEXT,\n                last_error TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", []) completed
2026-02-01 03:05:24 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000088565C0>, "\n            CREATE TABLE IF NOT EXISTS channels (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                channel_id INTEGER UNIQUE,\n                username TEXT,\n                title TEXT,\n                discussion_id INTEGER,\n                status TEXT DEFAULT 'active',\n                deletion_count INTEGER DEFAULT 0,\n                last_post_at TEXT,\n                last_comment_at TEXT,\n                sleep_until TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", [])
2026-02-01 03:05:24 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000088565C0>, "\n            CREATE TABLE IF NOT EXISTS channels (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                channel_id INTEGER UNIQUE,\n                username TEXT,\n                title TEXT,\n                discussion_id INTEGER,\n                status TEXT DEFAULT 'active',\n                deletion_count INTEGER DEFAULT 0,\n                last_post_at TEXT,\n                last_comment_at TEXT,\n                sleep_until TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", []) completed
2026-02-01 03:05:24 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000088565C0>, "\n            CREATE TABLE IF NOT EXISTS comments (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                comment_id INTEGER NOT NULL,\n                peer_id INTEGER NOT NULL,\n                channel_id INTEGER NOT NULL,\n                account_id INTEGER NOT NULL,\n                post_id INTEGER NOT NULL,\n                text TEXT,\n                status TEXT DEFAULT 'sent',\n                checked_at TEXT,\n                deleted_at TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                UNIQUE(peer_id, comment_id)\n            )\n        ", [])
2026-02-01 03:05:24 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000088565C0>, "\n            CREATE TABLE IF NOT EXISTS comments (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                comment_id INTEGER NOT NULL,\n                peer_id INTEGER NOT NULL,\n                channel_id INTEGER NOT NULL,\n                account_id INTEGER NOT NULL,\n                post_id INTEGER NOT NULL,\n                text TEXT,\n                status TEXT DEFAULT 'sent',\n                checked_at TEXT,\n                deleted_at TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                UNIQUE(peer_id, comment_id)\n            )\n        ", []) completed
2026-02-01 03:05:24 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000088565C0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_status \n            ON comments(status)\n        ', [])
2026-02-01 03:05:24 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000088565C0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_status \n            ON comments(status)\n        ', []) completed
2026-02-01 03:05:24 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000088565C0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_channel \n            ON comments(channel_id)\n        ', [])
2026-02-01 03:05:24 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000088565C0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_channel \n            ON comments(channel_id)\n        ', []) completed
2026-02-01 03:05:24 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000088565C0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_peer \n            ON comments(peer_id, comment_id)\n        ', [])
2026-02-01 03:05:24 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000088565C0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_peer \n            ON comments(peer_id, comment_id)\n        ', []) completed
2026-02-01 03:05:24 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000088565C0>, '\n            CREATE TABLE IF NOT EXISTS actions (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                action_type TEXT,\n                account_id INTEGER,\n                channel_id INTEGER,\n                details TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ', [])
2026-02-01 03:05:24 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000088565C0>, '\n            CREATE TABLE IF NOT EXISTS actions (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                action_type TEXT,\n                account_id INTEGER,\n                channel_id INTEGER,\n                details TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ', []) completed
2026-02-01 03:05:24 [DEB] executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000000088565C0>)
2026-02-01 03:05:24 [DEB] operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000000088565C0>) completed
2026-02-01 03:05:24 [INF] База данных инициализирована: C:\Users\admin\Desktop\project\data\bot.db
2026-02-01 03:05:24 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000088565C0>, '\n                    SELECT COUNT(*) FROM comments \n                    WHERE date(created_at) = ?\n                ', ('2026-02-01',))
2026-02-01 03:05:24 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000088565C0>, '\n                    SELECT COUNT(*) FROM comments \n                    WHERE date(created_at) = ?\n                ', ('2026-02-01',)) completed
2026-02-01 03:05:24 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B7C0>)
2026-02-01 03:05:24 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B7C0>) completed
2026-02-01 03:05:24 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000088565C0>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'sent' AND date(created_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:05:24 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000088565C0>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'sent' AND date(created_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:05:24 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884BA40>)
2026-02-01 03:05:24 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884BA40>) completed
2026-02-01 03:05:24 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000088565C0>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'deleted' AND date(deleted_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:05:24 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000088565C0>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'deleted' AND date(deleted_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:05:24 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B7C0>)
2026-02-01 03:05:24 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B7C0>) completed
2026-02-01 03:05:24 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000088565C0>, "\n                    SELECT COUNT(*) FROM actions \n                    WHERE action_type = 'warmup' AND date(created_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:05:24 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000088565C0>, "\n                    SELECT COUNT(*) FROM actions \n                    WHERE action_type = 'warmup' AND date(created_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:05:24 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884BA40>)
2026-02-01 03:05:24 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884BA40>) completed
2026-02-01 03:05:33 [DEB] Calling on_part_begin with no data
2026-02-01 03:05:33 [DEB] Calling on_header_field with data[42:61]
2026-02-01 03:05:33 [DEB] Calling on_header_value with data[63:93]
2026-02-01 03:05:33 [DEB] Calling on_header_end with no data
2026-02-01 03:05:33 [DEB] Calling on_headers_finished with no data
2026-02-01 03:05:33 [DEB] Calling on_part_data with data[97:105]
2026-02-01 03:05:33 [DEB] Calling on_part_end with no data
2026-02-01 03:05:33 [DEB] Calling on_end with no data
2026-02-01 03:05:46 [DEB] executing <function connect.<locals>.connector at 0x000000000849A660>
2026-02-01 03:05:46 [DEB] operation <function connect.<locals>.connector at 0x000000000849A660> completed
2026-02-01 03:05:46 [DEB] executing <function Connection.stop.<locals>.close_and_stop at 0x000000000849A480>
2026-02-01 03:05:46 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B25C0>, "\n            CREATE TABLE IF NOT EXISTS accounts (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                phone TEXT UNIQUE,\n                session_file TEXT,\n                pool_type TEXT DEFAULT 'comments',\n                status TEXT DEFAULT 'active',\n                warmup_level INTEGER DEFAULT 0,\n                comments_today INTEGER DEFAULT 0,\n                last_comment_at TEXT,\n                last_error TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", [])
2026-02-01 03:05:46 [DEB] operation <function Connection.stop.<locals>.close_and_stop at 0x000000000849A480> completed
2026-02-01 03:05:46 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B25C0>, "\n            CREATE TABLE IF NOT EXISTS accounts (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                phone TEXT UNIQUE,\n                session_file TEXT,\n                pool_type TEXT DEFAULT 'comments',\n                status TEXT DEFAULT 'active',\n                warmup_level INTEGER DEFAULT 0,\n                comments_today INTEGER DEFAULT 0,\n                last_comment_at TEXT,\n                last_error TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", []) completed
2026-02-01 03:05:46 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B25C0>, "\n            CREATE TABLE IF NOT EXISTS channels (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                channel_id INTEGER UNIQUE,\n                username TEXT,\n                title TEXT,\n                discussion_id INTEGER,\n                status TEXT DEFAULT 'active',\n                deletion_count INTEGER DEFAULT 0,\n                last_post_at TEXT,\n                last_comment_at TEXT,\n                sleep_until TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", [])
2026-02-01 03:05:46 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B25C0>, "\n            CREATE TABLE IF NOT EXISTS channels (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                channel_id INTEGER UNIQUE,\n                username TEXT,\n                title TEXT,\n                discussion_id INTEGER,\n                status TEXT DEFAULT 'active',\n                deletion_count INTEGER DEFAULT 0,\n                last_post_at TEXT,\n                last_comment_at TEXT,\n                sleep_until TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", []) completed
2026-02-01 03:05:46 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B25C0>, "\n            CREATE TABLE IF NOT EXISTS comments (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                comment_id INTEGER NOT NULL,\n                peer_id INTEGER NOT NULL,\n                channel_id INTEGER NOT NULL,\n                account_id INTEGER NOT NULL,\n                post_id INTEGER NOT NULL,\n                text TEXT,\n                status TEXT DEFAULT 'sent',\n                checked_at TEXT,\n                deleted_at TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                UNIQUE(peer_id, comment_id)\n            )\n        ", [])
2026-02-01 03:05:46 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B25C0>, "\n            CREATE TABLE IF NOT EXISTS comments (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                comment_id INTEGER NOT NULL,\n                peer_id INTEGER NOT NULL,\n                channel_id INTEGER NOT NULL,\n                account_id INTEGER NOT NULL,\n                post_id INTEGER NOT NULL,\n                text TEXT,\n                status TEXT DEFAULT 'sent',\n                checked_at TEXT,\n                deleted_at TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                UNIQUE(peer_id, comment_id)\n            )\n        ", []) completed
2026-02-01 03:05:46 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B25C0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_status \n            ON comments(status)\n        ', [])
2026-02-01 03:05:46 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B25C0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_status \n            ON comments(status)\n        ', []) completed
2026-02-01 03:05:46 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B25C0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_channel \n            ON comments(channel_id)\n        ', [])
2026-02-01 03:05:46 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B25C0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_channel \n            ON comments(channel_id)\n        ', []) completed
2026-02-01 03:05:46 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B25C0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_peer \n            ON comments(peer_id, comment_id)\n        ', [])
2026-02-01 03:05:46 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B25C0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_peer \n            ON comments(peer_id, comment_id)\n        ', []) completed
2026-02-01 03:05:46 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B25C0>, '\n            CREATE TABLE IF NOT EXISTS actions (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                action_type TEXT,\n                account_id INTEGER,\n                channel_id INTEGER,\n                details TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ', [])
2026-02-01 03:05:46 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B25C0>, '\n            CREATE TABLE IF NOT EXISTS actions (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                action_type TEXT,\n                account_id INTEGER,\n                channel_id INTEGER,\n                details TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ', []) completed
2026-02-01 03:05:46 [DEB] executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000000084B25C0>)
2026-02-01 03:05:46 [DEB] operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000000084B25C0>) completed
2026-02-01 03:05:46 [INF] База данных инициализирована: C:\Users\admin\Desktop\project\data\bot.db
2026-02-01 03:05:46 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B25C0>, '\n                    SELECT COUNT(*) FROM comments \n                    WHERE date(created_at) = ?\n                ', ('2026-02-01',))
2026-02-01 03:05:46 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B25C0>, '\n                    SELECT COUNT(*) FROM comments \n                    WHERE date(created_at) = ?\n                ', ('2026-02-01',)) completed
2026-02-01 03:05:46 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B040>)
2026-02-01 03:05:46 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B040>) completed
2026-02-01 03:05:46 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B25C0>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'sent' AND date(created_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:05:46 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B25C0>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'sent' AND date(created_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:05:46 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884BA40>)
2026-02-01 03:05:46 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884BA40>) completed
2026-02-01 03:05:46 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B25C0>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'deleted' AND date(deleted_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:05:46 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B25C0>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'deleted' AND date(deleted_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:05:46 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B040>)
2026-02-01 03:05:46 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884B040>) completed
2026-02-01 03:05:46 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B25C0>, "\n                    SELECT COUNT(*) FROM actions \n                    WHERE action_type = 'warmup' AND date(created_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:05:46 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B25C0>, "\n                    SELECT COUNT(*) FROM actions \n                    WHERE action_type = 'warmup' AND date(created_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:05:46 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884BA40>)
2026-02-01 03:05:46 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884BA40>) completed
2026-02-01 03:05:53 [DEB] executing <function connect.<locals>.connector at 0x0000000008499E40>
2026-02-01 03:05:53 [DEB] operation <function connect.<locals>.connector at 0x0000000008499E40> completed
2026-02-01 03:05:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B07C0>, "\n            CREATE TABLE IF NOT EXISTS accounts (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                phone TEXT UNIQUE,\n                session_file TEXT,\n                pool_type TEXT DEFAULT 'comments',\n                status TEXT DEFAULT 'active',\n                warmup_level INTEGER DEFAULT 0,\n                comments_today INTEGER DEFAULT 0,\n                last_comment_at TEXT,\n                last_error TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", [])
2026-02-01 03:05:53 [DEB] executing <function Connection.stop.<locals>.close_and_stop at 0x000000000849A840>
2026-02-01 03:05:53 [DEB] operation <function Connection.stop.<locals>.close_and_stop at 0x000000000849A840> completed
2026-02-01 03:05:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B07C0>, "\n            CREATE TABLE IF NOT EXISTS accounts (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                phone TEXT UNIQUE,\n                session_file TEXT,\n                pool_type TEXT DEFAULT 'comments',\n                status TEXT DEFAULT 'active',\n                warmup_level INTEGER DEFAULT 0,\n                comments_today INTEGER DEFAULT 0,\n                last_comment_at TEXT,\n                last_error TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", []) completed
2026-02-01 03:05:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B07C0>, "\n            CREATE TABLE IF NOT EXISTS channels (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                channel_id INTEGER UNIQUE,\n                username TEXT,\n                title TEXT,\n                discussion_id INTEGER,\n                status TEXT DEFAULT 'active',\n                deletion_count INTEGER DEFAULT 0,\n                last_post_at TEXT,\n                last_comment_at TEXT,\n                sleep_until TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", [])
2026-02-01 03:05:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B07C0>, "\n            CREATE TABLE IF NOT EXISTS channels (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                channel_id INTEGER UNIQUE,\n                username TEXT,\n                title TEXT,\n                discussion_id INTEGER,\n                status TEXT DEFAULT 'active',\n                deletion_count INTEGER DEFAULT 0,\n                last_post_at TEXT,\n                last_comment_at TEXT,\n                sleep_until TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", []) completed
2026-02-01 03:05:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B07C0>, "\n            CREATE TABLE IF NOT EXISTS comments (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                comment_id INTEGER NOT NULL,\n                peer_id INTEGER NOT NULL,\n                channel_id INTEGER NOT NULL,\n                account_id INTEGER NOT NULL,\n                post_id INTEGER NOT NULL,\n                text TEXT,\n                status TEXT DEFAULT 'sent',\n                checked_at TEXT,\n                deleted_at TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                UNIQUE(peer_id, comment_id)\n            )\n        ", [])
2026-02-01 03:05:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B07C0>, "\n            CREATE TABLE IF NOT EXISTS comments (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                comment_id INTEGER NOT NULL,\n                peer_id INTEGER NOT NULL,\n                channel_id INTEGER NOT NULL,\n                account_id INTEGER NOT NULL,\n                post_id INTEGER NOT NULL,\n                text TEXT,\n                status TEXT DEFAULT 'sent',\n                checked_at TEXT,\n                deleted_at TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                UNIQUE(peer_id, comment_id)\n            )\n        ", []) completed
2026-02-01 03:05:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B07C0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_status \n            ON comments(status)\n        ', [])
2026-02-01 03:05:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B07C0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_status \n            ON comments(status)\n        ', []) completed
2026-02-01 03:05:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B07C0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_channel \n            ON comments(channel_id)\n        ', [])
2026-02-01 03:05:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B07C0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_channel \n            ON comments(channel_id)\n        ', []) completed
2026-02-01 03:05:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B07C0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_peer \n            ON comments(peer_id, comment_id)\n        ', [])
2026-02-01 03:05:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B07C0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_peer \n            ON comments(peer_id, comment_id)\n        ', []) completed
2026-02-01 03:05:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B07C0>, '\n            CREATE TABLE IF NOT EXISTS actions (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                action_type TEXT,\n                account_id INTEGER,\n                channel_id INTEGER,\n                details TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ', [])
2026-02-01 03:05:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B07C0>, '\n            CREATE TABLE IF NOT EXISTS actions (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                action_type TEXT,\n                account_id INTEGER,\n                channel_id INTEGER,\n                details TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ', []) completed
2026-02-01 03:05:53 [DEB] executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000000084B07C0>)
2026-02-01 03:05:53 [DEB] operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000000084B07C0>) completed
2026-02-01 03:05:53 [INF] База данных инициализирована: C:\Users\admin\Desktop\project\data\bot.db
2026-02-01 03:05:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B07C0>, '\n                    SELECT COUNT(*) FROM comments \n                    WHERE date(created_at) = ?\n                ', ('2026-02-01',))
2026-02-01 03:05:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B07C0>, '\n                    SELECT COUNT(*) FROM comments \n                    WHERE date(created_at) = ?\n                ', ('2026-02-01',)) completed
2026-02-01 03:05:53 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884BA40>)
2026-02-01 03:05:53 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884BA40>) completed
2026-02-01 03:05:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B07C0>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'sent' AND date(created_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:05:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B07C0>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'sent' AND date(created_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:05:53 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x00000000084C87C0>)
2026-02-01 03:05:53 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x00000000084C87C0>) completed
2026-02-01 03:05:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B07C0>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'deleted' AND date(deleted_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:05:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B07C0>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'deleted' AND date(deleted_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:05:53 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884BA40>)
2026-02-01 03:05:53 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000000000884BA40>) completed
2026-02-01 03:05:53 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B07C0>, "\n                    SELECT COUNT(*) FROM actions \n                    WHERE action_type = 'warmup' AND date(created_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:05:53 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B07C0>, "\n                    SELECT COUNT(*) FROM actions \n                    WHERE action_type = 'warmup' AND date(created_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:05:53 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x00000000084C87C0>)
2026-02-01 03:05:53 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x00000000084C87C0>) completed
2026-02-01 03:05:54 [DEB] executing <function connect.<locals>.connector at 0x000000000849A7A0>
2026-02-01 03:05:54 [DEB] operation <function connect.<locals>.connector at 0x000000000849A7A0> completed
2026-02-01 03:05:54 [DEB] executing <function Connection.stop.<locals>.close_and_stop at 0x000000000849A5C0>
2026-02-01 03:05:54 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B23E0>, "\n            CREATE TABLE IF NOT EXISTS accounts (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                phone TEXT UNIQUE,\n                session_file TEXT,\n                pool_type TEXT DEFAULT 'comments',\n                status TEXT DEFAULT 'active',\n                warmup_level INTEGER DEFAULT 0,\n                comments_today INTEGER DEFAULT 0,\n                last_comment_at TEXT,\n                last_error TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", [])
2026-02-01 03:05:54 [DEB] operation <function Connection.stop.<locals>.close_and_stop at 0x000000000849A5C0> completed
2026-02-01 03:05:54 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B23E0>, "\n            CREATE TABLE IF NOT EXISTS accounts (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                phone TEXT UNIQUE,\n                session_file TEXT,\n                pool_type TEXT DEFAULT 'comments',\n                status TEXT DEFAULT 'active',\n                warmup_level INTEGER DEFAULT 0,\n                comments_today INTEGER DEFAULT 0,\n                last_comment_at TEXT,\n                last_error TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", []) completed
2026-02-01 03:05:54 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B23E0>, "\n            CREATE TABLE IF NOT EXISTS channels (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                channel_id INTEGER UNIQUE,\n                username TEXT,\n                title TEXT,\n                discussion_id INTEGER,\n                status TEXT DEFAULT 'active',\n                deletion_count INTEGER DEFAULT 0,\n                last_post_at TEXT,\n                last_comment_at TEXT,\n                sleep_until TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", [])
2026-02-01 03:05:54 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B23E0>, "\n            CREATE TABLE IF NOT EXISTS channels (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                channel_id INTEGER UNIQUE,\n                username TEXT,\n                title TEXT,\n                discussion_id INTEGER,\n                status TEXT DEFAULT 'active',\n                deletion_count INTEGER DEFAULT 0,\n                last_post_at TEXT,\n                last_comment_at TEXT,\n                sleep_until TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", []) completed
2026-02-01 03:05:54 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B23E0>, "\n            CREATE TABLE IF NOT EXISTS comments (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                comment_id INTEGER NOT NULL,\n                peer_id INTEGER NOT NULL,\n                channel_id INTEGER NOT NULL,\n                account_id INTEGER NOT NULL,\n                post_id INTEGER NOT NULL,\n                text TEXT,\n                status TEXT DEFAULT 'sent',\n                checked_at TEXT,\n                deleted_at TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                UNIQUE(peer_id, comment_id)\n            )\n        ", [])
2026-02-01 03:05:54 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B23E0>, "\n            CREATE TABLE IF NOT EXISTS comments (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                comment_id INTEGER NOT NULL,\n                peer_id INTEGER NOT NULL,\n                channel_id INTEGER NOT NULL,\n                account_id INTEGER NOT NULL,\n                post_id INTEGER NOT NULL,\n                text TEXT,\n                status TEXT DEFAULT 'sent',\n                checked_at TEXT,\n                deleted_at TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                UNIQUE(peer_id, comment_id)\n            )\n        ", []) completed
2026-02-01 03:05:54 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B23E0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_status \n            ON comments(status)\n        ', [])
2026-02-01 03:05:54 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B23E0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_status \n            ON comments(status)\n        ', []) completed
2026-02-01 03:05:54 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B23E0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_channel \n            ON comments(channel_id)\n        ', [])
2026-02-01 03:05:54 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B23E0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_channel \n            ON comments(channel_id)\n        ', []) completed
2026-02-01 03:05:54 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B23E0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_peer \n            ON comments(peer_id, comment_id)\n        ', [])
2026-02-01 03:05:54 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B23E0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_peer \n            ON comments(peer_id, comment_id)\n        ', []) completed
2026-02-01 03:05:54 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B23E0>, '\n            CREATE TABLE IF NOT EXISTS actions (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                action_type TEXT,\n                account_id INTEGER,\n                channel_id INTEGER,\n                details TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ', [])
2026-02-01 03:05:54 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B23E0>, '\n            CREATE TABLE IF NOT EXISTS actions (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                action_type TEXT,\n                account_id INTEGER,\n                channel_id INTEGER,\n                details TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ', []) completed
2026-02-01 03:05:54 [DEB] executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000000084B23E0>)
2026-02-01 03:05:54 [DEB] operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000000084B23E0>) completed
2026-02-01 03:05:54 [INF] База данных инициализирована: C:\Users\admin\Desktop\project\data\bot.db
2026-02-01 03:05:54 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B23E0>, '\n                    SELECT COUNT(*) FROM comments \n                    WHERE date(created_at) = ?\n                ', ('2026-02-01',))
2026-02-01 03:05:54 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B23E0>, '\n                    SELECT COUNT(*) FROM comments \n                    WHERE date(created_at) = ?\n                ', ('2026-02-01',)) completed
2026-02-01 03:05:54 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x00000000084C8740>)
2026-02-01 03:05:54 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x00000000084C8740>) completed
2026-02-01 03:05:54 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B23E0>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'sent' AND date(created_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:05:54 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B23E0>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'sent' AND date(created_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:05:54 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x00000000084C88C0>)
2026-02-01 03:05:54 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x00000000084C88C0>) completed
2026-02-01 03:05:54 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B23E0>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'deleted' AND date(deleted_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:05:54 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B23E0>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'deleted' AND date(deleted_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:05:54 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x00000000084C8740>)
2026-02-01 03:05:54 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x00000000084C8740>) completed
2026-02-01 03:05:54 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B23E0>, "\n                    SELECT COUNT(*) FROM actions \n                    WHERE action_type = 'warmup' AND date(created_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:05:54 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B23E0>, "\n                    SELECT COUNT(*) FROM actions \n                    WHERE action_type = 'warmup' AND date(created_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:05:54 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x00000000084C88C0>)
2026-02-01 03:05:54 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x00000000084C88C0>) completed
2026-02-01 03:06:23 [DEB] executing <function connect.<locals>.connector at 0x000000000849A700>
2026-02-01 03:06:23 [DEB] operation <function connect.<locals>.connector at 0x000000000849A700> completed
2026-02-01 03:06:23 [DEB] executing <function Connection.stop.<locals>.close_and_stop at 0x00000000084996C0>
2026-02-01 03:06:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B27A0>, "\n            CREATE TABLE IF NOT EXISTS accounts (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                phone TEXT UNIQUE,\n                session_file TEXT,\n                pool_type TEXT DEFAULT 'comments',\n                status TEXT DEFAULT 'active',\n                warmup_level INTEGER DEFAULT 0,\n                comments_today INTEGER DEFAULT 0,\n                last_comment_at TEXT,\n                last_error TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", [])
2026-02-01 03:06:23 [DEB] operation <function Connection.stop.<locals>.close_and_stop at 0x00000000084996C0> completed
2026-02-01 03:06:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B27A0>, "\n            CREATE TABLE IF NOT EXISTS accounts (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                phone TEXT UNIQUE,\n                session_file TEXT,\n                pool_type TEXT DEFAULT 'comments',\n                status TEXT DEFAULT 'active',\n                warmup_level INTEGER DEFAULT 0,\n                comments_today INTEGER DEFAULT 0,\n                last_comment_at TEXT,\n                last_error TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", []) completed
2026-02-01 03:06:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B27A0>, "\n            CREATE TABLE IF NOT EXISTS channels (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                channel_id INTEGER UNIQUE,\n                username TEXT,\n                title TEXT,\n                discussion_id INTEGER,\n                status TEXT DEFAULT 'active',\n                deletion_count INTEGER DEFAULT 0,\n                last_post_at TEXT,\n                last_comment_at TEXT,\n                sleep_until TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", [])
2026-02-01 03:06:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B27A0>, "\n            CREATE TABLE IF NOT EXISTS channels (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                channel_id INTEGER UNIQUE,\n                username TEXT,\n                title TEXT,\n                discussion_id INTEGER,\n                status TEXT DEFAULT 'active',\n                deletion_count INTEGER DEFAULT 0,\n                last_post_at TEXT,\n                last_comment_at TEXT,\n                sleep_until TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ", []) completed
2026-02-01 03:06:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B27A0>, "\n            CREATE TABLE IF NOT EXISTS comments (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                comment_id INTEGER NOT NULL,\n                peer_id INTEGER NOT NULL,\n                channel_id INTEGER NOT NULL,\n                account_id INTEGER NOT NULL,\n                post_id INTEGER NOT NULL,\n                text TEXT,\n                status TEXT DEFAULT 'sent',\n                checked_at TEXT,\n                deleted_at TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                UNIQUE(peer_id, comment_id)\n            )\n        ", [])
2026-02-01 03:06:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B27A0>, "\n            CREATE TABLE IF NOT EXISTS comments (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                comment_id INTEGER NOT NULL,\n                peer_id INTEGER NOT NULL,\n                channel_id INTEGER NOT NULL,\n                account_id INTEGER NOT NULL,\n                post_id INTEGER NOT NULL,\n                text TEXT,\n                status TEXT DEFAULT 'sent',\n                checked_at TEXT,\n                deleted_at TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n                UNIQUE(peer_id, comment_id)\n            )\n        ", []) completed
2026-02-01 03:06:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B27A0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_status \n            ON comments(status)\n        ', [])
2026-02-01 03:06:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B27A0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_status \n            ON comments(status)\n        ', []) completed
2026-02-01 03:06:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B27A0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_channel \n            ON comments(channel_id)\n        ', [])
2026-02-01 03:06:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B27A0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_channel \n            ON comments(channel_id)\n        ', []) completed
2026-02-01 03:06:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B27A0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_peer \n            ON comments(peer_id, comment_id)\n        ', [])
2026-02-01 03:06:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B27A0>, '\n            CREATE INDEX IF NOT EXISTS idx_comments_peer \n            ON comments(peer_id, comment_id)\n        ', []) completed
2026-02-01 03:06:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B27A0>, '\n            CREATE TABLE IF NOT EXISTS actions (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                action_type TEXT,\n                account_id INTEGER,\n                channel_id INTEGER,\n                details TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ', [])
2026-02-01 03:06:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B27A0>, '\n            CREATE TABLE IF NOT EXISTS actions (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                action_type TEXT,\n                account_id INTEGER,\n                channel_id INTEGER,\n                details TEXT,\n                created_at TEXT DEFAULT CURRENT_TIMESTAMP\n            )\n        ', []) completed
2026-02-01 03:06:23 [DEB] executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000000084B27A0>)
2026-02-01 03:06:23 [DEB] operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000000084B27A0>) completed
2026-02-01 03:06:23 [INF] База данных инициализирована: C:\Users\admin\Desktop\project\data\bot.db
2026-02-01 03:06:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B27A0>, '\n                    SELECT COUNT(*) FROM comments \n                    WHERE date(created_at) = ?\n                ', ('2026-02-01',))
2026-02-01 03:06:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B27A0>, '\n                    SELECT COUNT(*) FROM comments \n                    WHERE date(created_at) = ?\n                ', ('2026-02-01',)) completed
2026-02-01 03:06:23 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x00000000084C8A40>)
2026-02-01 03:06:23 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x00000000084C8A40>) completed
2026-02-01 03:06:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B27A0>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'sent' AND date(created_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:06:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B27A0>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'sent' AND date(created_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:06:23 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x00000000084C8940>)
2026-02-01 03:06:23 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x00000000084C8940>) completed
2026-02-01 03:06:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B27A0>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'deleted' AND date(deleted_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:06:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B27A0>, "\n                    SELECT COUNT(*) FROM comments \n                    WHERE status = 'deleted' AND date(deleted_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:06:23 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x00000000084C8840>)
2026-02-01 03:06:23 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x00000000084C8840>) completed
2026-02-01 03:06:23 [DEB] executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B27A0>, "\n                    SELECT COUNT(*) FROM actions \n                    WHERE action_type = 'warmup' AND date(created_at) = ?\n                ", ('2026-02-01',))
2026-02-01 03:06:23 [DEB] operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000000084B27A0>, "\n                    SELECT COUNT(*) FROM actions \n                    WHERE action_type = 'warmup' AND date(created_at) = ?\n                ", ('2026-02-01',)) completed
2026-02-01 03:06:23 [DEB] executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x00000000084C8940>)
2026-02-01 03:06:23 [DEB] operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x00000000084C8940>) completed
